{
  "tool_id": "scan_code",
  "name": "Scan Code for Crypto Vulnerabilities",
  "description": "Analyzes source code for quantum-vulnerable cryptographic algorithms and generates NIST 800-53 SC-13 compliance reports.",
  "input_schema": {
    "type": "object",
    "properties": {
      "path": {
        "type": "string",
        "description": "Path to source code directory or file to scan"
      },
      "language": {
        "type": "string",
        "enum": ["javascript", "python", "java", "cpp", "go", "rust", "csharp", "typescript"],
        "description": "Programming language of the source code (auto-detected if not specified)"
      },
      "format": {
        "type": "string",
        "enum": ["sc13", "oscal"],
        "default": "sc13",
        "description": "Output format: sc13 (NIST 800-53 SC-13) or oscal (OSCAL 1.1.2)"
      }
    },
    "required": ["path"]
  },
  "output_schema": {
    "type": "object",
    "properties": {
      "report": {
        "type": "object",
        "description": "Complete compliance report with findings and recommendations"
      },
      "summary": {
        "type": "object",
        "properties": {
          "files_scanned": {"type": "integer"},
          "lines_scanned": {"type": "integer"},
          "vulnerabilities_found": {"type": "integer"},
          "compliance_score": {"type": "integer", "minimum": 0, "maximum": 100},
          "risk_score": {"type": "integer", "minimum": 0, "maximum": 100},
          "critical_count": {"type": "integer"},
          "high_count": {"type": "integer"},
          "medium_count": {"type": "integer"}
        }
      },
      "vulnerabilities": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "crypto_type": {"type": "string"},
            "severity": {"type": "string", "enum": ["critical", "high", "medium", "low"]},
            "line": {"type": "integer"},
            "message": {"type": "string"},
            "recommendation": {"type": "string"}
          }
        }
      }
    }
  },
  "metadata": {
    "cost_estimate": 0.001,
    "latency": "100-2000ms",
    "category": "security",
    "tags": ["cryptography", "quantum-safe", "compliance", "nist", "security-scan"]
  }
}
